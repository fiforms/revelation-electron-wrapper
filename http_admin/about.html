<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>About REVELation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: system-ui, sans-serif;
      background-color: #111;
      color: #f4f4f4;
      padding: 2rem;
      max-width: 800px;
      margin: 0 auto;
      line-height: 1.6;
    }
    h1, h2 {
      color: #fff;
    }
    a {
      color: #4da6ff;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    .section {
      margin-bottom: 2rem;
    }
    .button {
      display: inline-block;
      padding: 0.6rem 1.2rem;
      background: #0070f3;
      color: white;
      border-radius: 6px;
      margin-top: 0.5rem;
    }
    .button:hover {
      background: #005ac1;
    }
    .button.disabled {
      background: #555;
      cursor: not-allowed;
      opacity: 0.7;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <h1>About REVELation Snapshot Presenter</h1>
  <h2>Version <span id="app-version">loading...</span></h2>
  <a class="button" id="check-updates">Check for Updates</a>
  <div id="update-result"></div>
  <div class="section">
    <p>
      Check out the REVELation Snapshot Presenter home page online for documentation, videos, and more:
      <a class="button" href="https://snapshots.vrbm.org/revelation-snapshot-presenter/" target="_blank">
        Visit REVELation Snapshot Presenter Home
      </a>
    </p>
  </div>
  <div class="section">
    <h2>üì¶ Snapshot Builder (Desktop GUI)</h2>
    <p>
      The <strong>REVELation Snapshot Builder</strong> is a cross-platform desktop app built with Electron. 
      It provides a user-friendly interface to create, manage, and export Reveal.js-based presentations using the REVELation framework.
    </p>
    <p>Features include:</p>
    <ul>
      <li>Easy-to-build Markdown presentations based on Reveal.js</li>
      <li>Media Library with rich metadata</li>
      <li>Rich plugin framework</li>
      <li>Built-in plugins to create slides for songs and Scripture verses</li>
      <li>One-click exporting to portable HTML/ZIP</li>
      <li>Remote control and multi-screen presentation support</li>
    </ul>
    <p>
      Source code and releases are available on GitHub:<br>
      <a class="button" href="https://github.com/fiforms/revelation-electron-wrapper" target="_blank">
        Visit Snapshot Builder on GitHub
      </a>
    </p>
  </div>

  <div class="section">
    <h2>üìΩÔ∏è Snapshot Presenter (Internal Framework)</h2>
    <p>
      The <strong>REVELation Snapshot Presenter Framework</strong> is a modular presentation framework built on <a href="https://revealjs.com/" target="_blank">Reveal.js</a>. 
      It enhances Markdown-based presentations with:
    </p>
    <ul>
      <li>Background images and looping videos</li>
      <li>Custom slide macros and fragment syntax</li>
      <li>A presentation index page and YAML-driven configuration</li>
      <li>Live dev server with LAN support and remote sync</li>
    </ul>
    <p>
      Source code and documentation can be found here:<br>
      <a class="button" href="https://github.com/fiforms/revelation" target="_blank">
        Visit Snapshot Presenter on GitHub
      </a>
    </p>
  </div>

  <div class="section">
    <h2>License</h2>
    <p>This software itself is licensed under a permissive MIT-style license. However, the project release includes software that is licensed
    under other more restrictive licenses such as the GNU General Public License (GPL) and the GNU LGPL, which places some restrictions on 
    how you can re-distrubte it. In particular, it must include some notice like this one with a link to the license and you must make
    the source code available if you make modifications and distribute it.</p>

    The following third-party components are included in this release:
    <ul>
      <li>Reveal.js - MIT License - <a href="https://github.com/hakimel/reveal.js" target="_blank">GitHub</a></li>
      <li>FFmpeg - LGPL & GPL License - <a href="https://www.ffmpeg.org/" target="_blank">Website</a></li>
      <li>Electron - MIT License - <a href="https://github.com/electron/electron" target="_blank">GitHub</a></li>
      <li>Node.js - MIT License - <a href="https://nodejs.org/" target="_blank">Website</a></li>
      <li>Highlight.js - MIT License - <a href="https://github.com/highlightjs/highlight.js" target="_blank">GitHub</a></li>
      <li>Marked - MIT License - <a href="https://github.com/markedjs/marked" target="_blank">GitHub</a></li>
      <li>JS-YAML - MIT License - <a href="https://github.com/nodeca/js-yaml" target="_blank">GitHub</a></li>
      <li>Poppler (PDF Processing) - GPL License - <a href="https://poppler.freedesktop.org/" target="_blank">Website</a></li>
      <li>Numerous smaller components with MIT or similar permissive licenses</li>
    </ul>
    <p>For the full text of the MIT License, please visit <a href="https://opensource.org/licenses/MIT" target="_blank">https://opensource.org/licenses/MIT</a></p>
    <p>For the full text of the GNU General Public License (GPL), please visit <a href="https://www.gnu.org/licenses/gpl-2.0.html" target="_blank">https://www.gnu.org/licenses/gpl-3.0.html</a></p>
  </div>

    <script>
      window.addEventListener('DOMContentLoaded', async () => {
        const versionSpan = document.getElementById('app-version');
        const updateButton = document.getElementById('check-updates');
        const resultDiv = document.getElementById('update-result');

        try {
          const version = await window.electronAPI.getAppVersion();
          versionSpan.textContent = version;
        } catch (err) {
          versionSpan.textContent = 'unknown';
          console.error('Failed to get app version:', err);
        }

        let config = {};
        try {
          config = await window.electronAPI.getAppConfig();
        } catch (err) {
          console.error('Failed to load app config:', err);
        }

        updateButton.addEventListener('click', async () => {
          updateButton.classList.add('disabled');
          updateButton.setAttribute('aria-disabled', 'true');
          updateButton.textContent = 'Checking...';
          resultDiv.textContent = '';

          try {
            const result = await window.electronAPI.checkForUpdates({ force: true });
            const latestVersion = result?.latest?.version;

            if (result?.status === 'up-to-date') {
              const version = await window.electronAPI.getAppVersion();
              if(version === latestVersion) {
                resultDiv.textContent = '‚úÖ You are using the latest version.';
              }
              else {
                resultDiv.textContent = `üîî You are using a pre-release version. Latest version online is: ${latestVersion}`;
              }
            } else if (result?.status === 'update-available') {
              resultDiv.textContent = `üîî Update available: ${latestVersion}`;
            } else if (result?.status === 'ignored') {
              resultDiv.textContent = '‚ÑπÔ∏è Latest version is currently ignored.';
            } else if (result?.status === 'error') {
              resultDiv.textContent = '‚ùå Failed to check for updates.';
            } else {
              resultDiv.textContent = '';
            }
          } catch (err) {
            resultDiv.textContent = '‚ùå Failed to check for updates.';
            console.error(err);
          } finally {
            updateButton.classList.remove('disabled');
            updateButton.removeAttribute('aria-disabled');
            updateButton.textContent = 'Check for Updates';
          }
        });
      });
    </script>
</body>
</html>
